å‰ç«¯åŒæ­¥æŒ‡ä»¤ (COPY THIS)
ğŸ”´ é«˜å„ªå…ˆç´šä¿®æ­£ (API å‘¼å«æœƒå¤±æ•—)
1. ä½ç½®æ›´æ–° API
æª”æ¡ˆ: src/services/api.ts:849, src/screens/LocationScreen.tsx:61

// âŒ éŒ¯èª¤å¯«æ³•
await api.post('/api/location/update', {
  latitude: coords.latitude,
  longitude: coords.longitude,
  isSharingEnabled: true
});
// âœ… æ­£ç¢ºå¯«æ³•
await api.post('/api/location/update', {
  lat: coords.latitude,
  lng: coords.longitude
});
2. SOS Link å›å‚³æ¬„ä½
æª”æ¡ˆ: src/services/api.ts:812

// âŒ éŒ¯èª¤å¯«æ³•
const { link } = await api.get('/api/user/sos-link');
setSosLink(link);
// âœ… æ­£ç¢ºå¯«æ³•
const { sosLink, sosKey } = await api.get('/api/user/sos-link');
setSosLink(sosLink);
// sosKey æ˜¯ 64 å­—å…ƒçš„å¯†é‘°ï¼Œå¯é¸æ“‡é¡¯ç¤ºçµ¦ç”¨æˆ¶
ğŸŸ¡ ä¸­ç­‰å„ªå…ˆç´š (å‹åˆ¥å®šç¾©å·®ç•°)
3. InventoryItem å‹åˆ¥ä¿®æ­£
// âŒ å‰ç«¯éŒ¯èª¤å®šç¾©
interface InventoryItem {
  itemType: string;  // éŒ¯èª¤
  code: string;      // æ‰å¹³åŒ–
  merchantName: string;
  terms: string;
}
// âœ… æ­£ç¢ºå®šç¾© (å°é½Šå¾Œç«¯)
interface InventoryItem {
  id: number;
  type: 'coupon' | 'item';  // ä¸æ˜¯ itemType
  name: string;
  description: string | null;
  rarity: 'SP' | 'SSR' | 'SR' | 'S' | 'R';
  isRead: boolean;
  isRedeemed: boolean;
  expiresAt: string | null;
  obtainedAt: string;
  couponData?: {           // å·¢ç‹€çµæ§‹ï¼Œä¸æ˜¯æ‰å¹³åŒ–
    code: string;
    merchantName: string;
    terms: string;
  };
}
4. MerchantAnalytics å‹åˆ¥ä¿®æ­£
// âŒ å‰ç«¯éŒ¯èª¤å®šç¾©
interface MerchantAnalytics {
  totalItineraryCards: number;
  totalCoupons: number;
}
// âœ… æ­£ç¢ºå®šç¾© (å°é½Šå¾Œç«¯)
interface MerchantAnalytics {
  itineraryCardCount: number;  // ä¸æ˜¯ totalItineraryCards
  couponStats: {               // å·¢ç‹€çµæ§‹
    total: number;
    active: number;
    redeemed: number;
  };
  impressions: number;
  collectionClickCount: number;
}
// ä½¿ç”¨ç¯„ä¾‹
const analytics = await api.get('/api/merchant/analytics');
const totalCoupons = analytics.couponStats.total;  // ä¸æ˜¯ analytics.totalCoupons
5. å„ªæƒ åˆ¸å…Œæ›å›æ‡‰ä¿®æ­£
// âŒ å‰ç«¯éŒ¯èª¤å®šç¾©
interface RedeemResponse {
  redemptionId: number;  // éŒ¯èª¤
}
// âœ… æ­£ç¢ºå®šç¾©
interface RedeemResponse {
  success: boolean;
  redemptionCode: string;  // æ˜¯ string ä¸æ˜¯ numberï¼Œæ¬„ä½åæ˜¯ redemptionCode
  expiresAt: string;
}
6. ItineraryCoupon.id å‹åˆ¥
// âŒ å‰ç«¯éŒ¯èª¤å®šç¾©
interface ItineraryCoupon {
  id: string;  // éŒ¯èª¤
}
// âœ… æ­£ç¢ºå®šç¾©
interface ItineraryCoupon {
  id: number;  // å¾Œç«¯æ˜¯ number
  title: string;
  code: string;
  terms: string | null;
}
7. Country / Region å‹åˆ¥ä¿®æ­£
// âŒ å‰ç«¯æœŸå¾…å¤šèªè¨€æ¬„ä½
interface Country {
  nameEn: string;
  nameZh: string;
  nameJa: string;
  nameKo: string;
}
// âœ… å¾Œç«¯å¯¦éš›å›å‚³ (ç°¡åŒ–ç‰ˆ)
interface Country {
  id: number;
  name: string;  // å¾Œç«¯å·²æ ¹æ“š Accept-Language å›å‚³å°æ‡‰èªè¨€
  code: string;
}
interface Region {
  id: number;
  name: string;  // ç°¡åŒ–ç‰ˆï¼Œä¸æ˜¯å¤šèªè¨€æ¬„ä½
  countryId: number;
}
8. GachaItem æ¬„ä½åç¨± (snake_case â†’ camelCase)
// âŒ å‰ç«¯éŒ¯èª¤ä½¿ç”¨
interface GachaItem {
  place_name: string;  // snake_case éŒ¯èª¤
}
// âœ… æ­£ç¢ºå®šç¾©
interface GachaItem {
  placeName: string;   // camelCase
  category: string;
  subcategory: string | null;
  description: string | null;
  address: string | null;
  rating: number | null;
  locationLat: number | null;
  locationLng: number | null;
}
ğŸ“‹ å®Œæ•´å‹åˆ¥å®šç¾©æª” (å»ºè­°è¦†è“‹)
// types/api.ts
// ===== ä½ç½®æ›´æ–° =====
interface LocationUpdateRequest {
  lat: number;
  lng: number;
}
// ===== SOS =====
interface SosLinkResponse {
  sosLink: string;
  sosKey: string;
}
// ===== é“å…·ç®± =====
interface InventoryItem {
  id: number;
  type: 'coupon' | 'item';
  name: string;
  description: string | null;
  rarity: 'SP' | 'SSR' | 'SR' | 'S' | 'R';
  isRead: boolean;
  isRedeemed: boolean;
  expiresAt: string | null;
  obtainedAt: string;
  couponData?: {
    code: string;
    merchantName: string;
    terms: string;
  };
}
interface RedeemResponse {
  success: boolean;
  redemptionCode: string;
  expiresAt: string;
}
// ===== å•†å®¶åˆ†æ =====
interface MerchantAnalytics {
  itineraryCardCount: number;
  couponStats: {
    total: number;
    active: number;
    redeemed: number;
  };
  impressions: number;
  collectionClickCount: number;
}
// ===== åœ°ç†è³‡è¨Š =====
interface Country {
  id: number;
  name: string;
  code: string;
}
interface Region {
  id: number;
  name: string;
  countryId: number;
}
// ===== æ‰­è›‹ =====
interface GachaPlace {
  id: number;
  placeName: string;      // camelCase
  category: string;
  subcategory: string | null;
  description: string | null;
  address: string | null;
  rating: number | null;
  locationLat: number | null;
  locationLng: number | null;
}
interface ItineraryCoupon {
  id: number;             // number ä¸æ˜¯ string
  title: string;
  code: string;
  terms: string | null;
}
âš ï¸ ä¿®æ”¹æ‘˜è¦
å•é¡Œ	å‰ç«¯ç¾æ³	å¾Œç«¯è¦æ ¼	å‹•ä½œ
ä½ç½®æ›´æ–°åƒæ•¸	latitude, longitude	lat, lng	æ”¹å‰ç«¯
SOS Link æ¬„ä½	link	sosLink, sosKey	æ”¹å‰ç«¯
Inventory type	itemType	type	æ”¹å‰ç«¯
Inventory coupon	æ‰å¹³åŒ–	couponData å·¢ç‹€	æ”¹å‰ç«¯
Analytics æ¬„ä½	totalItineraryCards	itineraryCardCount	æ”¹å‰ç«¯
Analytics çµæ§‹	æ‰å¹³	couponStats å·¢ç‹€	æ”¹å‰ç«¯
Redeem å›æ‡‰	redemptionId	redemptionCode	æ”¹å‰ç«¯
Coupon ID å‹åˆ¥	string	number	æ”¹å‰ç«¯
Place æ¬„ä½	place_name	placeName	æ”¹å‰ç«¯
æ‰€æœ‰å•é¡Œéƒ½éœ€è¦å‰ç«¯ä¿®æ”¹ï¼Œå¾Œç«¯ API è¦æ ¼ä¸è®Šã€‚